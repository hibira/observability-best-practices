# アラーム

Amazon CloudWatch アラームを使用すると、CloudWatch メトリクスとログの閾値を定義し、CloudWatch で設定されたルールに基づいて通知を受け取ることができます。

**CloudWatch メトリクスのアラーム:**

CloudWatch アラームを使用すると、CloudWatch メトリクスの閾値を定義し、メトリクスが範囲外になったときに通知を受け取ることができます。各メトリクスは複数のアラームをトリガーでき、各アラームには多くのアクションを関連付けることができます。CloudWatch メトリクスに基づいてメトリクスアラームを設定する方法は 2 つあります。

1. **静的閾値**: 静的閾値は、メトリクスが違反してはならない固定の制限を表します。通常の運用時の動作を理解するために、上限と下限の範囲を定義する必要があります。メトリクス値が静的閾値を下回るか上回った場合、CloudWatch がアラームを生成するように設定できます。

2. **異常検出**: 異常検出は、一般的にデータの大部分から大きく逸脱し、正常な動作の明確な概念に準拠しない稀な項目、イベント、または観測値として識別されます。CloudWatch の異常検出は、過去のメトリクスデータを分析し、予想される値のモデルを作成します。予想される値には、メトリクスの典型的な時間、日次、週次のパターンが考慮されます。必要に応じて各メトリクスに異常検出を適用でき、CloudWatch は機械学習アルゴリズムを適用して、有効化された各メトリクスの上限と下限を定義し、メトリクスが予想される値の範囲外になった場合にのみアラームを生成します。

!!! tip
	静的閾値は、ワークロードの特定のパフォーマンスブレークポイントやインフラストラクチャコンポーネントの絶対的な制限など、メトリクスを確実に理解している場合に最適です。

!!! success
	特定のメトリクスの時間的なパフォーマンスが見えない場合や、負荷テストや異常なトラフィックでメトリクス値が観測されていない場合は、アラームで異常検出モデルを使用してください。

![CloudWatch アラームの種類](../images/cwalarm1.png)

CloudWatch での静的アラームと異常検出ベースのアラームの設定方法については、以下の手順に従ってください。

[静的閾値アラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/mericalarm)

[CloudWatch 異常検出ベースのアラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/adalarm)

!!! success
	アラーム疲労を軽減したり、生成されるアラームの数からのノイズを減らすには、アラームを設定する際に 2 つの高度な方法があります。

	1. **複合アラーム**: 複合アラームには、作成済みの他のアラームの状態を考慮するルール式が含まれています。複合アラームは、ルールのすべての条件が満たされた場合にのみ `ALARM` 状態になります。複合アラームのルール式で指定されるアラームには、メトリクスアラームと他の複合アラームを含めることができます。複合アラームは、[集約によるアラーム疲労の軽減](../../signals/alarms/#fight-alarm-fatigue-with-aggregation)に役立ちます。

	2. **メトリクス数式ベースのアラーム**: メトリクス数式を使用すると、より意味のあるKPIを作成し、それらにアラームを設定できます。複数のメトリクスを組み合わせて、統合された利用率メトリクスを作成し、それにアラームを設定できます。

複合アラームとメトリクス数式ベースのアラームの設定方法については、以下の手順に従ってください。

[複合アラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/compositealarm)

[メトリクス数式アラーム](https://aws.amazon.com/blogs/mt/create-a-metric-math-alarm-using-amazon-cloudwatch/)

**CloudWatch ログのアラーム**

CloudWatch ログに基づいてアラームを作成できます。CloudWatch ログは CloudWatch メトリクスフィルターを使用します。メトリクスフィルターは、ログデータを数値の CloudWatch メトリクスに変換し、それをグラフ化またはアラームを設定できるようにします。メトリクスを設定したら、CloudWatch ログから生成された CloudWatch メトリクスに対して静的アラームまたは異常検出ベースのアラームを使用できます。

[CloudWatch ログのメトリクスフィルターの設定例](https://aws.amazon.com/blogs/mt/quantify-custom-application-metrics-with-amazon-cloudwatch-logs-and-metric-filters/)をご覧ください。
